* cl-duckdb (WiP)

#+begin_html
<div align="center">
  <a href="https://upload.wikimedia.org/wikipedia/commons/4/43/Pair_of_mandarin_ducks.jpg" target="_blank">
    <img alt="鴛鴦戲水" title="鴛鴦戲水" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Pair_of_mandarin_ducks.jpg/440px-Pair_of_mandarin_ducks.jpg" width="220" height="165">
  </a>
</div>
<p align="center">
  <a href="https://github.com/ak-coram/cl-duckdb/actions">
    <img alt="Build Status" src="https://github.com/ak-coram/cl-duckdb/workflows/CI/badge.svg" />
  </a>
</p>
#+end_html

This is a CFFI wrapper around the [[https://duckdb.org/][DuckDB]] C API.

** Development setup

Currently only Linux, BSDs, Windows and macOS are tested (x86-64).

- Install [[https://sbcl.org/][SBCL]], [[https://www.quicklisp.org/][Quicklisp]], [[https://sourceware.org/libffi/][libffi]] and of course [[https://duckdb.org/][DuckDB]].
- Clone this repository and add it as a local Quicklisp project, for
  example:

#+begin_src sh
  git clone git@github.com:ak-coram/cl-duckdb.git ~/Projects/cl-duckdb
  ln -s ~/Projects/cl-duckdb ~/quicklisp/local-projects/cl-duckdb
#+end_src

- Start your favored REPL (e.g. sbcl) and load the library using
  Quicklisp:

#+begin_src lisp
  (ql:quickload :duckdb)
#+end_src

*** Running tests

- Load the tests via Quicklisp:

#+begin_src lisp
  (ql:quickload :duckdb/test)
#+end_src

- Use [[https://asdf.common-lisp.dev/][ASDF]] or [[https://fiveam.common-lisp.dev/][FiveAM]] to run the tests:

#+begin_src lisp
  ;; Using ASDF:
  (asdf:test-system :duckdb)
  ;; Using FiveAM directly:
  (fiveam:run! :duckdb)
#+end_src

** Roadmap

- [X] Support for querying built-in general-purpose types
  - [X] NULL
  - [X] VARCHAR
  - [X] BOOLEAN
  - [X] TINYINT
  - [X] SMALLINT
  - [X] INTEGER
  - [X] BIGINT
  - [X] HUGEINT
  - [X] UTINYINT
  - [X] USMALLINT
  - [X] UINTEGER
  - [X] UBIGINT
  - [X] REAL (FLOAT)
  - [X] DOUBLE
  - [X] BLOB
  - [X] DATE
  - [X] DECIMAL(s, p)
  - [X] TIMESTAMP
  - [X] TIMESTAMP WITH TIME ZONE
  - [X] INTERVAL
  - [X] TIME
  - [X] UUID
- [-] Support for binding built-in general-purpose types
  - [X] NULL
  - [X] VARCHAR
  - [X] BOOLEAN
  - [X] TINYINT
  - [X] SMALLINT
  - [X] INTEGER
  - [X] BIGINT
  - [X] HUGEINT
  - [X] UTINYINT
  - [X] USMALLINT
  - [X] UINTEGER
  - [X] UBIGINT
  - [X] REAL (FLOAT)
  - [X] DOUBLE
  - [ ] BLOB
  - [ ] DATE
  - [ ] DECIMAL(s, p)
  - [ ] TIMESTAMP
  - [ ] TIMESTAMP WITH TIME ZONE
  - [ ] INTERVAL
  - [ ] TIME
  - [ ] UUID
- [ ] Support for querying nested / composite types
- [ ] Support for binding nested / composite types
- [ ] ...

** License

- Released under the MIT License, same as DuckDB.
- [[https://en.wikipedia.org/wiki/File:Pair_of_mandarin_ducks.jpg][Source]] for README photo
